<!DOCTYPE html>
<html>
<head>
  <title>Average color</title>
  <meta charset="utf-8" />
  <style>
    img {
        width: 100%;
    }

    .item {
        float: left;
        width: 400px;
        border: 1px solid rgba(77, 77, 77, 0.5);
        padding: 10px;
        margin: 10px;
    }

    .item__text {
        padding: 10px;
        height: 3em;
    }
  </style>
</head>
<body>
    <div class="item">
        <img src="image1.png" />
        <div class="item__text">
            Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
        </div>
    </div>

    <div class="item">
        <img src="image2.png" />
        <div class="item__text">
            Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
        </div>
    </div>

    <div class="item">
        <img src="image3.png" />
        <div class="item__text">
            Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
        </div>
    </div>

    <script>

    var AverageColor = {
        get: function(image) {
            var canvas = document.createElement('canvas'),
                size = 1;

            canvas.width = canvas.height = size;

            var ctx = canvas.getContext('2d');
            ctx.drawImage(image, 0, 0, image.width, image.height, 0, 0, size, size);

            var bitmap = ctx.getImageData(0, 0, size, size),
                color = [bitmap.data[0], bitmap.data[1], bitmap.data[2]]; // [r, g, b]

            return {
                rgb: 'rgb(' + color.join(',') + ')',
                color: color,
                isDark: this.isDark(color)
            };
        },
        isDark: function(color) {
            var count = 0;
            color.forEach(function(colorComponent) {
                count += colorComponent < 128 ? 1 : 0;
            }, this);

            return count >= 2;
        }
    };

    window.onload = function() {
        var items = document.querySelectorAll('.item');

        for (var i = 0; i < items.length; i++) {
            var item = items[i],
                color = AverageColor.get(item.querySelector('img'));

            item.style.backgroundColor = color.rgb;
            item.style.color =  color.isDark ? 'white' : 'black';
        }
    };
    </script>
</body>
</html>
