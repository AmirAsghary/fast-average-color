/*! Fast Average Color | Â© 2018 Denis Seleznev | MIT License | https://github.com/hcodes/fast-average-color/ */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.FastAverageColor=t()}(this,function(){"use strict";var e=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();return function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.defaultColor=e&&e.defaultColor||[255,255,255,255]}return e(t,[{key:"getColor",value:function(e,t,n){var r=n&&n.data;e instanceof HTMLImageElement?e.complete||e.naturalWidth?t.call(e,this.getColorSync.apply(this,arguments),r):this._bindImageEvents(e,t,n):e instanceof HTMLCanvasElement&&t.call(e,this.getColorSync.apply(this,arguments),r)}},{key:"getColorSync",value:function(e,t){t=t||{};var n=this._canvas||document.createElement("canvas"),r=this._getDefaultColor(t);n.width=n.height=1;var o=n.getContext("2d"),a=null,i="left"in t?t.left:0,l="top"in t?t.top:0,u="width"in t?t.width:e.width,s="height"in t?t.height:e.height,f=r;try{o.clearRect(0,0,1,1),o.drawImage(e,i,l,u,s,0,0,1,1);var h=o.getImageData(0,0,1,1).data;f=[h[0],h[1],h[2],h[3]]}catch(e){a=e}return this._getResult(f,a)}},{key:"getColorFromArray3",value:function(e){if(e.length<3)return this._getDefaultColor();for(var t=e.length-e.length%3,n=0,r=0,o=0,a=0,i=0;i<t;i+=3)n+=e[i],r+=e[i+1],o+=e[i+2],a++;return[Math.floor(n/a),Math.floor(r/a),Math.floor(o/a),255]}},{key:"getColorFromArray4",value:function(e){if(e.length<4)return this._getDefaultColor();for(var t=e.length-e.length%4,n=0,r=0,o=0,a=0,i=0,l=0;l<t;l+=4)n+=e[l],r+=e[l+1],o+=e[l+2],a+=e[l+3],i++;return[Math.floor(n/i),Math.floor(r/i),Math.floor(o/i),Math.floor(a/i)]}},{key:"destroy",value:function(){delete this._canvas}},{key:"_getDefaultColor",value:function(e){return e&&e.defaultColor||this.defaultColor}},{key:"_bindImageEvents",value:function(e,t,n){var r=this,o=n&&n.data;this._onload=function(){r._unbindImageEvents(),t.call(e,r.getColorSync(e,n),o)},this._onerror=function(){r._unbindImageEvents(),t.call(e,r._getResult(r._getDefaultColor(),new Error("Image error")),o)},this._onabort=function(){r._unbindImageEvents(),t.call(e,r._getResult(r._getDefaultColor(),new Error("Image abort")),o)},e.addEventListener("load",this._onload),e.addEventListener("error",this._onerror),e.addEventListener("abort",this._onabort)}},{key:"_unbindImageEvents",value:function(e){e.removeEventListener("load",this._onload),e.removeEventListener("error",this._onerror),e.removeEventListener("abort",this._onabort)}},{key:"_getResult",value:function(e,t){var n=e.slice(0,3),r=[].concat(n,e[3]/255);return{error:t,value:e,rgb:"rgb("+n.join(",")+")",rgba:"rgba("+r.join(",")+")",hex:this._arrayToHex(n),hexa:this._arrayToHex(e),isDark:this._isDark(e)}}},{key:"_toHex",value:function(e){var t=e.toString(16);return 1===t.length?"0"+t:t}},{key:"_arrayToHex",value:function(e){return"#"+e.map(this._toHex).join("")}},{key:"_isDark",value:function(e){var t=0;return e.forEach(function(e){t+=e<128?1:0}),t>=2}}]),t}()});