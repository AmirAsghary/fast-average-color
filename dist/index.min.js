/*! Fast Average Color | Â© 2018 Denis Seleznev | MIT License | https://github.com/hcodes/fast-average-color/ */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.FastAverageColor=e()}(this,function(){"use strict";var t=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();return function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.defaultColor=t&&t.defaultColor||[255,255,255,255]}return t(e,[{key:"getColor",value:function(t,e,r){var n=r&&r.data;t instanceof HTMLImageElement?t.complete||t.naturalWidth?e.call(t,this.getColorSync.apply(this,arguments),n):this._bindImageEvents(t,e,r):t instanceof HTMLCanvasElement&&e.call(t,this.getColorSync.apply(this,arguments),n)}},{key:"getColorSync",value:function(t,e){e=e||{};var r=this._getDefaultColor(e),n=this._ctx;if(!n){var o=document.createElement("canvas");if(o.width=o.height=1,!(n=o.getContext&&o.getContext("2d")))return this._getResult(r,new Error("Canvas: Context 2D is not supported in this browser."));this._ctx=n}var a=null,i="left"in e?e.left:0,l="top"in e?e.top:0,u="width"in e?e.width:t.width,s="height"in e?e.height:t.height,f=r;try{n.clearRect(0,0,1,1),n.drawImage(t,i,l,u,s,0,0,1,1);var h=n.getImageData(0,0,1,1).data;f=[h[0],h[1],h[2],h[3]]}catch(t){a=t}return this._getResult(f,a)}},{key:"getColorFromArray3",value:function(t,e){if(t.length<3)return this._getDefaultColor();for(var r=t.length-t.length%3,n=3*(e||1),o=0,a=0,i=0,l=0,u=0;u<r;u+=n)o+=t[u],a+=t[u+1],i+=t[u+2],l++;return[Math.floor(o/l),Math.floor(a/l),Math.floor(i/l),255]}},{key:"getColorFromArray4",value:function(t,e){if(t.length<4)return this._getDefaultColor();for(var r=t.length-t.length%4,n=4*(e||1),o=0,a=0,i=0,l=0,u=0,s=0;s<r;s+=n)o+=t[s],a+=t[s+1],i+=t[s+2],l+=t[s+3],u++;return[Math.floor(o/u),Math.floor(a/u),Math.floor(i/u),Math.floor(l/u)]}},{key:"destroy",value:function(){delete this._ctx}},{key:"_getDefaultColor",value:function(t){return t&&t.defaultColor||this.defaultColor}},{key:"_bindImageEvents",value:function(t,e,r){var n=this,o=r&&r.data;this._onload=function(){n._unbindImageEvents(),e.call(t,n.getColorSync(t,r),o)},this._onerror=function(){n._unbindImageEvents(),e.call(t,n._getResult(n._getDefaultColor(),new Error("Image error")),o)},this._onabort=function(){n._unbindImageEvents(),e.call(t,n._getResult(n._getDefaultColor(),new Error("Image abort")),o)},t.addEventListener("load",this._onload),t.addEventListener("error",this._onerror),t.addEventListener("abort",this._onabort)}},{key:"_unbindImageEvents",value:function(t){t.removeEventListener("load",this._onload),t.removeEventListener("error",this._onerror),t.removeEventListener("abort",this._onabort)}},{key:"_getResult",value:function(t,e){var r=t.slice(0,3),n=[].concat(r,t[3]/255);return{error:e,value:t,rgb:"rgb("+r.join(",")+")",rgba:"rgba("+n.join(",")+")",hex:this._arrayToHex(r),hexa:this._arrayToHex(t),isDark:this._isDark(t)}}},{key:"_toHex",value:function(t){var e=t.toString(16);return 1===e.length?"0"+e:e}},{key:"_arrayToHex",value:function(t){return"#"+t.map(this._toHex).join("")}},{key:"_isDark",value:function(t){var e=0;return t.forEach(function(t){e+=t<128?1:0}),e>=2}}]),e}()});