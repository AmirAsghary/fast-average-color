/*! Fast Average Color | Â© 2018 Denis Seleznev | MIT License | https://github.com/hcodes/fast-average-color/ */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.FastAverageColor=t()}(this,function(){"use strict";var e=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();return function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.defaultColor=e&&e.defaultColor||[255,255,255,255]}return e(t,[{key:"get",value:function(e,t,n){e instanceof HTMLImageElement?e.complete||e.naturalWidth?n(this.getSync.apply(this,arguments)):this.bindImageEvents(e,t,n):e instanceof HTMLCanvasElement&&n(this.getSync.apply(this,arguments))}},{key:"getSync",value:function(e,t){t=t||{};var n=this._canvas||document.createElement("canvas"),r=this._getDefaultColor(t);n.width=n.height=1;var o=n.getContext("2d"),a=null,i="left"in t?t.left:0,u="top"in t?t.top:0,s="width"in t?t.width:e.width,l="height"in t?t.height:e.height,c=r;try{o.drawImage(e,i,u,s,l,0,0,1,1);var h=o.getImageData(0,0,1,1).data;c=[h[0],h[1],h[2],h[3]]}catch(e){a=e}return this._getResult(c,a)}},{key:"destroy",value:function(){delete this._canvas}},{key:"_getDefaultColor",value:function(e){return e&&e.defaultColor||this.defaultColor}},{key:"_bindImageEvents",value:function(e,t,n){var r=this;this._onload=this._oncached=function(){r._unbindImageEvents(),n(r.getSync(e,t))},this._onerror=function(){r._unbindImageEvents(),n(r._getResult(r._getDefaultColor(),new Error("Image error")))},this._onabort=function(){r._unbindImageEvents(),n(r._getResult(r._getDefaultColor(),new Error("Image abort")))},e.addEventListener("load",this._onload),e.addEventListener("cached",this._onload),e.addEventListener("error",this._onerror),e.addEventListener("abort",this._onabort)}},{key:"_unbindImageEvents",value:function(e){e.removeEventListener("load",this._onload),e.removeEventListener("cached",this._onload),e.removeEventListener("error",this._onerror),e.removeEventListener("abort",this._onabort)}},{key:"_getResult",value:function(e,t){var n=e.slice(0,3),r=[].concat(n,Math.floor(e[3]/255));return{rgb:"rgb("+n.join(",")+")",rgba:"rgba("+r.join(",")+")",hex:this._arrayToHex(n),hexa:this._arrayToHex(e),value:e,error:t,isDark:this._isDark(e)}}},{key:"_toHex",value:function(e){var t=e.toString(16);return 1===t.length?"0"+t:t}},{key:"_arrayToHex",value:function(e){return"#"+e.map(this._toHex).join("")}},{key:"_isDark",value:function(e){var t=0;return e.forEach(function(e){t+=e<128?1:0}),t>=2}}]),t}()});